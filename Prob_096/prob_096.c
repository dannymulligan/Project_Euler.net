// Project Euler.net Problem 96
//
// Su Doku (Japanese meaning number place) is the name given to a popular
// puzzle concept. Its origin is unclear, but credit must be attributed
// to Leonhard Euler who invented a similar, and much more difficult,
// puzzle idea called Latin Squares. The objective of Su Doku puzzles,
// however, is to replace the blanks (or zeros) in a 9 by 9 grid in such
// that each row, column, and 3 by 3 box contains each of the digits 1 to
// 9. Below is an example of a typical starting puzzle grid and its
// solution grid.
//
//     +-------+-------+-------+    +-------+-------+-------+
//     | 0 0 3 | 0 2 0 | 6 0 0 |    | 4 8 3 | 9 2 1 | 6 5 7 |
//     | 9 0 0 | 3 0 5 | 0 0 1 |    | 9 6 7 | 3 4 5 | 8 2 1 |
//     | 0 0 1 | 8 0 6 | 4 0 0 |    | 2 5 1 | 8 7 6 | 4 9 3 |
//     +-------+-------+-------+    +-------+-------+-------+
//     | 0 0 8 | 1 0 2 | 9 0 0 |    | 5 4 8 | 1 3 2 | 9 7 6 |
//     | 7 0 0 | 0 0 0 | 0 0 8 |    | 7 2 9 | 5 6 4 | 1 3 8 |
//     | 0 0 6 | 7 0 8 | 2 0 0 |    | 1 3 6 | 7 9 8 | 2 4 5 |
//     +-------+-------+-------+    +-------+-------+-------+
//     | 0 0 2 | 6 0 9 | 5 0 0 |    | 3 7 2 | 6 8 9 | 5 1 4 |
//     | 8 0 0 | 2 0 3 | 0 0 9 |    | 8 1 4 | 2 5 3 | 7 6 9 |
//     | 0 0 5 | 0 1 0 | 3 0 0 |    | 6 9 5 | 4 1 7 | 3 8 2 |
//     +-------+-------+-------+    +-------+-------+-------+
//
// A well constructed Su Doku puzzle has a unique solution and can be
// solved by logic, although it may be necessary to employ "guess and
// test" methods in order to eliminate options (there is much contested
// opinion over this). The complexity of the search determines the
// difficulty of the puzzle; the example above is considered easy because
// it can be solved by straight forward direct deduction.
//
// The 6K text file, sudoku.txt (right click and 'Save Link/Target
// As...'), contains fifty different Su Doku puzzles ranging in
// difficulty, but all with unique solutions (the first puzzle in the
// file is the example above).
//
// By solving all fifty puzzles find the sum of the 3-digit numbers found
// in the top left corner of each solution grid; for example, 483 is the
// 3-digit number found in the top left corner of the solution grid
// above.
//
// $Revision

#include <stdio.h>

FILE *fin;
char name[256];
char temp[10];
int sudoku[9][9];
int solutions_found;
int blkd[9][9][10];
int i, j, k;
int tries = 0;
int answer = 0;

void print_blkd ()
{
    char s[9][9][10];
    int i, j;

    for (i=0; i<9; i++) {
        for (j=0; j<9; j++) {
            if (blkd[i][j][1] == 0)  s[i][j][1] = '1';  else  s[i][j][1] = ' ';
            if (blkd[i][j][2] == 0)  s[i][j][2] = '2';  else  s[i][j][2] = ' ';
            if (blkd[i][j][3] == 0)  s[i][j][3] = '3';  else  s[i][j][3] = ' ';
            if (blkd[i][j][4] == 0)  s[i][j][4] = '4';  else  s[i][j][4] = ' ';
            if (blkd[i][j][5] == 0)  s[i][j][5] = '5';  else  s[i][j][5] = ' ';
            if (blkd[i][j][6] == 0)  s[i][j][6] = '6';  else  s[i][j][6] = ' ';
            if (blkd[i][j][7] == 0)  s[i][j][7] = '7';  else  s[i][j][7] = ' ';
            if (blkd[i][j][8] == 0)  s[i][j][8] = '8';  else  s[i][j][8] = ' ';
            if (blkd[i][j][9] == 0)  s[i][j][9] = '9';  else  s[i][j][9] = ' ';
        }
    }

    printf("+-----------+------------+----------+\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[0][0][1], s[0][0][2], s[0][0][3],    s[0][1][1], s[0][1][2], s[0][1][3],    s[0][2][1], s[0][2][2], s[0][2][3],    s[0][3][1], s[0][3][2], s[0][3][3],    s[0][4][1], s[0][4][2], s[0][4][3],    s[0][5][1], s[0][5][2], s[0][5][3],    s[0][6][1], s[0][6][2], s[0][6][3],    s[0][7][1], s[0][7][2], s[0][7][3],    s[0][8][1], s[0][8][2], s[0][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[0][0][4], s[0][0][5], s[0][0][6],    s[0][1][4], s[0][1][5], s[0][1][6],    s[0][2][4], s[0][2][5], s[0][2][6],    s[0][3][4], s[0][3][5], s[0][3][6],    s[0][4][4], s[0][4][5], s[0][4][6],    s[0][5][4], s[0][5][5], s[0][5][6],    s[0][6][4], s[0][6][5], s[0][6][6],    s[0][7][4], s[0][7][5], s[0][7][6],    s[0][8][4], s[0][8][5], s[0][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[0][0][7], s[0][0][8], s[0][0][9],    s[0][1][7], s[0][1][8], s[0][1][9],    s[0][2][7], s[0][2][8], s[0][2][9],    s[0][3][7], s[0][3][8], s[0][3][9],    s[0][4][7], s[0][4][8], s[0][4][9],    s[0][5][7], s[0][5][8], s[0][5][9],    s[0][6][7], s[0][6][8], s[0][6][9],    s[0][7][7], s[0][7][8], s[0][7][9],    s[0][8][7], s[0][8][8], s[0][8][9]);
    printf("|...:...:...|...:...:...|...:...:...|\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[1][0][1], s[1][0][2], s[1][0][3],    s[1][1][1], s[1][1][2], s[1][1][3],    s[1][2][1], s[1][2][2], s[1][2][3],    s[1][3][1], s[1][3][2], s[1][3][3],    s[1][4][1], s[1][4][2], s[1][4][3],    s[1][5][1], s[1][5][2], s[1][5][3],    s[1][6][1], s[1][6][2], s[1][6][3],    s[1][7][1], s[1][7][2], s[1][7][3],    s[1][8][1], s[1][8][2], s[1][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[1][0][4], s[1][0][5], s[1][0][6],    s[1][1][4], s[1][1][5], s[1][1][6],    s[1][2][4], s[1][2][5], s[1][2][6],    s[1][3][4], s[1][3][5], s[1][3][6],    s[1][4][4], s[1][4][5], s[1][4][6],    s[1][5][4], s[1][5][5], s[1][5][6],    s[1][6][4], s[1][6][5], s[1][6][6],    s[1][7][4], s[1][7][5], s[1][7][6],    s[1][8][4], s[1][8][5], s[1][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[1][0][7], s[1][0][8], s[1][0][9],    s[1][1][7], s[1][1][8], s[1][1][9],    s[1][2][7], s[1][2][8], s[1][2][9],    s[1][3][7], s[1][3][8], s[1][3][9],    s[1][4][7], s[1][4][8], s[1][4][9],    s[1][5][7], s[1][5][8], s[1][5][9],    s[1][6][7], s[1][6][8], s[1][6][9],    s[1][7][7], s[1][7][8], s[1][7][9],    s[1][8][7], s[1][8][8], s[1][8][9]);
    printf("|...:...:...|...:...:...|...:...:...|\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[2][0][1], s[2][0][2], s[2][0][3],    s[2][1][1], s[2][1][2], s[2][1][3],    s[2][2][1], s[2][2][2], s[2][2][3],    s[2][3][1], s[2][3][2], s[2][3][3],    s[2][4][1], s[2][4][2], s[2][4][3],    s[2][5][1], s[2][5][2], s[2][5][3],    s[2][6][1], s[2][6][2], s[2][6][3],    s[2][7][1], s[2][7][2], s[2][7][3],    s[2][8][1], s[2][8][2], s[2][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[2][0][4], s[2][0][5], s[2][0][6],    s[2][1][4], s[2][1][5], s[2][1][6],    s[2][2][4], s[2][2][5], s[2][2][6],    s[2][3][4], s[2][3][5], s[2][3][6],    s[2][4][4], s[2][4][5], s[2][4][6],    s[2][5][4], s[2][5][5], s[2][5][6],    s[2][6][4], s[2][6][5], s[2][6][6],    s[2][7][4], s[2][7][5], s[2][7][6],    s[2][8][4], s[2][8][5], s[2][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[2][0][7], s[2][0][8], s[2][0][9],    s[2][1][7], s[2][1][8], s[2][1][9],    s[2][2][7], s[2][2][8], s[2][2][9],    s[2][3][7], s[2][3][8], s[2][3][9],    s[2][4][7], s[2][4][8], s[2][4][9],    s[2][5][7], s[2][5][8], s[2][5][9],    s[2][6][7], s[2][6][8], s[2][6][9],    s[2][7][7], s[2][7][8], s[2][7][9],    s[2][8][7], s[2][8][8], s[2][8][9]);
    printf("+-----------+-----------+-----------+\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[3][0][1], s[3][0][2], s[3][0][3],    s[3][1][1], s[3][1][2], s[3][1][3],    s[3][2][1], s[3][2][2], s[3][2][3],    s[3][3][1], s[3][3][2], s[3][3][3],    s[3][4][1], s[3][4][2], s[3][4][3],    s[3][5][1], s[3][5][2], s[3][5][3],    s[3][6][1], s[3][6][2], s[3][6][3],    s[3][7][1], s[3][7][2], s[3][7][3],    s[3][8][1], s[3][8][2], s[3][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[3][0][4], s[3][0][5], s[3][0][6],    s[3][1][4], s[3][1][5], s[3][1][6],    s[3][2][4], s[3][2][5], s[3][2][6],    s[3][3][4], s[3][3][5], s[3][3][6],    s[3][4][4], s[3][4][5], s[3][4][6],    s[3][5][4], s[3][5][5], s[3][5][6],    s[3][6][4], s[3][6][5], s[3][6][6],    s[3][7][4], s[3][7][5], s[3][7][6],    s[3][8][4], s[3][8][5], s[3][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[3][0][7], s[3][0][8], s[3][0][9],    s[3][1][7], s[3][1][8], s[3][1][9],    s[3][2][7], s[3][2][8], s[3][2][9],    s[3][3][7], s[3][3][8], s[3][3][9],    s[3][4][7], s[3][4][8], s[3][4][9],    s[3][5][7], s[3][5][8], s[3][5][9],    s[3][6][7], s[3][6][8], s[3][6][9],    s[3][7][7], s[3][7][8], s[3][7][9],    s[3][8][7], s[3][8][8], s[3][8][9]);
    printf("|...:...:...|...:...:...|...:...:...|\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[4][0][1], s[4][0][2], s[4][0][3],    s[4][1][1], s[4][1][2], s[4][1][3],    s[4][2][1], s[4][2][2], s[4][2][3],    s[4][3][1], s[4][3][2], s[4][3][3],    s[4][4][1], s[4][4][2], s[4][4][3],    s[4][5][1], s[4][5][2], s[4][5][3],    s[4][6][1], s[4][6][2], s[4][6][3],    s[4][7][1], s[4][7][2], s[4][7][3],    s[4][8][1], s[4][8][2], s[4][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[4][0][4], s[4][0][5], s[4][0][6],    s[4][1][4], s[4][1][5], s[4][1][6],    s[4][2][4], s[4][2][5], s[4][2][6],    s[4][3][4], s[4][3][5], s[4][3][6],    s[4][4][4], s[4][4][5], s[4][4][6],    s[4][5][4], s[4][5][5], s[4][5][6],    s[4][6][4], s[4][6][5], s[4][6][6],    s[4][7][4], s[4][7][5], s[4][7][6],    s[4][8][4], s[4][8][5], s[4][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[4][0][7], s[4][0][8], s[4][0][9],    s[4][1][7], s[4][1][8], s[4][1][9],    s[4][2][7], s[4][2][8], s[4][2][9],    s[4][3][7], s[4][3][8], s[4][3][9],    s[4][4][7], s[4][4][8], s[4][4][9],    s[4][5][7], s[4][5][8], s[4][5][9],    s[4][6][7], s[4][6][8], s[4][6][9],    s[4][7][7], s[4][7][8], s[4][7][9],    s[4][8][7], s[4][8][8], s[4][8][9]);
    printf("|...:...:...|...:...:...|...:...:...|\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[5][0][1], s[5][0][2], s[5][0][3],    s[5][1][1], s[5][1][2], s[5][1][3],    s[5][2][1], s[5][2][2], s[5][2][3],    s[5][3][1], s[5][3][2], s[5][3][3],    s[5][4][1], s[5][4][2], s[5][4][3],    s[5][5][1], s[5][5][2], s[5][5][3],    s[5][6][1], s[5][6][2], s[5][6][3],    s[5][7][1], s[5][7][2], s[5][7][3],    s[5][8][1], s[5][8][2], s[5][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[5][0][4], s[5][0][5], s[5][0][6],    s[5][1][4], s[5][1][5], s[5][1][6],    s[5][2][4], s[5][2][5], s[5][2][6],    s[5][3][4], s[5][3][5], s[5][3][6],    s[5][4][4], s[5][4][5], s[5][4][6],    s[5][5][4], s[5][5][5], s[5][5][6],    s[5][6][4], s[5][6][5], s[5][6][6],    s[5][7][4], s[5][7][5], s[5][7][6],    s[5][8][4], s[5][8][5], s[5][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[5][0][7], s[5][0][8], s[5][0][9],    s[5][1][7], s[5][1][8], s[5][1][9],    s[5][2][7], s[5][2][8], s[5][2][9],    s[5][3][7], s[5][3][8], s[5][3][9],    s[5][4][7], s[5][4][8], s[5][4][9],    s[5][5][7], s[5][5][8], s[5][5][9],    s[5][6][7], s[5][6][8], s[5][6][9],    s[5][7][7], s[5][7][8], s[5][7][9],    s[5][8][7], s[5][8][8], s[5][8][9]);
    printf("+-----------+-----------+-----------+\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[6][0][1], s[6][0][2], s[6][0][3],    s[6][1][1], s[6][1][2], s[6][1][3],    s[6][2][1], s[6][2][2], s[6][2][3],    s[6][3][1], s[6][3][2], s[6][3][3],    s[6][4][1], s[6][4][2], s[6][4][3],    s[6][5][1], s[6][5][2], s[6][5][3],    s[6][6][1], s[6][6][2], s[6][6][3],    s[6][7][1], s[6][7][2], s[6][7][3],    s[6][8][1], s[6][8][2], s[6][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[6][0][4], s[6][0][5], s[6][0][6],    s[6][1][4], s[6][1][5], s[6][1][6],    s[6][2][4], s[6][2][5], s[6][2][6],    s[6][3][4], s[6][3][5], s[6][3][6],    s[6][4][4], s[6][4][5], s[6][4][6],    s[6][5][4], s[6][5][5], s[6][5][6],    s[6][6][4], s[6][6][5], s[6][6][6],    s[6][7][4], s[6][7][5], s[6][7][6],    s[6][8][4], s[6][8][5], s[6][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[6][0][7], s[6][0][8], s[6][0][9],    s[6][1][7], s[6][1][8], s[6][1][9],    s[6][2][7], s[6][2][8], s[6][2][9],    s[6][3][7], s[6][3][8], s[6][3][9],    s[6][4][7], s[6][4][8], s[6][4][9],    s[6][5][7], s[6][5][8], s[6][5][9],    s[6][6][7], s[6][6][8], s[6][6][9],    s[6][7][7], s[6][7][8], s[6][7][9],    s[6][8][7], s[6][8][8], s[6][8][9]);
    printf("|...:...:...|...:...:...|...:...:...|\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[7][0][1], s[7][0][2], s[7][0][3],    s[7][1][1], s[7][1][2], s[7][1][3],    s[7][2][1], s[7][2][2], s[7][2][3],    s[7][3][1], s[7][3][2], s[7][3][3],    s[7][4][1], s[7][4][2], s[7][4][3],    s[7][5][1], s[7][5][2], s[7][5][3],    s[7][6][1], s[7][6][2], s[7][6][3],    s[7][7][1], s[7][7][2], s[7][7][3],    s[7][8][1], s[7][8][2], s[7][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[7][0][4], s[7][0][5], s[7][0][6],    s[7][1][4], s[7][1][5], s[7][1][6],    s[7][2][4], s[7][2][5], s[7][2][6],    s[7][3][4], s[7][3][5], s[7][3][6],    s[7][4][4], s[7][4][5], s[7][4][6],    s[7][5][4], s[7][5][5], s[7][5][6],    s[7][6][4], s[7][6][5], s[7][6][6],    s[7][7][4], s[7][7][5], s[7][7][6],    s[7][8][4], s[7][8][5], s[7][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[7][0][7], s[7][0][8], s[7][0][9],    s[7][1][7], s[7][1][8], s[7][1][9],    s[7][2][7], s[7][2][8], s[7][2][9],    s[7][3][7], s[7][3][8], s[7][3][9],    s[7][4][7], s[7][4][8], s[7][4][9],    s[7][5][7], s[7][5][8], s[7][5][9],    s[7][6][7], s[7][6][8], s[7][6][9],    s[7][7][7], s[7][7][8], s[7][7][9],    s[7][8][7], s[7][8][8], s[7][8][9]);
    printf("|...:...:...|...:...:...|...:...:...|\n");
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[8][0][1], s[8][0][2], s[8][0][3],    s[8][1][1], s[8][1][2], s[8][1][3],    s[8][2][1], s[8][2][2], s[8][2][3],    s[8][3][1], s[8][3][2], s[8][3][3],    s[8][4][1], s[8][4][2], s[8][4][3],    s[8][5][1], s[8][5][2], s[8][5][3],    s[8][6][1], s[8][6][2], s[8][6][3],    s[8][7][1], s[8][7][2], s[8][7][3],    s[8][8][1], s[8][8][2], s[8][8][3]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[8][0][4], s[8][0][5], s[8][0][6],    s[8][1][4], s[8][1][5], s[8][1][6],    s[8][2][4], s[8][2][5], s[8][2][6],    s[8][3][4], s[8][3][5], s[8][3][6],    s[8][4][4], s[8][4][5], s[8][4][6],    s[8][5][4], s[8][5][5], s[8][5][6],    s[8][6][4], s[8][6][5], s[8][6][6],    s[8][7][4], s[8][7][5], s[8][7][6],    s[8][8][4], s[8][8][5], s[8][8][6]);
    printf("|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|%c%c%c:%c%c%c:%c%c%c|\n",  s[8][0][7], s[8][0][8], s[8][0][9],    s[8][1][7], s[8][1][8], s[8][1][9],    s[8][2][7], s[8][2][8], s[8][2][9],    s[8][3][7], s[8][3][8], s[8][3][9],    s[8][4][7], s[8][4][8], s[8][4][9],    s[8][5][7], s[8][5][8], s[8][5][9],    s[8][6][7], s[8][6][8], s[8][6][9],    s[8][7][7], s[8][7][8], s[8][7][9],    s[8][8][7], s[8][8][8], s[8][8][9]);
    printf("+-----------+-----------+-----------+\n");
}

void print_solution ()
{
    char s[9][9];
    int i, j, n;

    for (i=0; i<9; i++) {
        for (j=0; j<9; j++) {
            s[i][j] = '.';
            for (n=1; n<=9; n++) {
                if (blkd[i][j][n] == 0)  s[i][j] = n + '0';
            }
        }
    }

    printf("+-------+-------+-------+\n");
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[0][0], s[0][1], s[0][2],    s[0][3], s[0][4], s[0][5],    s[0][6], s[0][7], s[0][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[1][0], s[1][1], s[1][2],    s[1][3], s[1][4], s[1][5],    s[1][6], s[1][7], s[1][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[2][0], s[2][1], s[2][2],    s[2][3], s[2][4], s[2][5],    s[2][6], s[2][7], s[2][8]);
    printf("+-------+-------+-------+\n");
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[3][0], s[3][1], s[3][2],    s[3][3], s[3][4], s[3][5],    s[3][6], s[3][7], s[3][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[4][0], s[4][1], s[4][2],    s[4][3], s[4][4], s[4][5],    s[4][6], s[4][7], s[4][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[5][0], s[5][1], s[5][2],    s[5][3], s[5][4], s[5][5],    s[5][6], s[5][7], s[5][8]);
    printf("+-------+-------+-------+\n");
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[6][0], s[6][1], s[6][2],    s[6][3], s[6][4], s[6][5],    s[6][6], s[6][7], s[6][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[7][0], s[7][1], s[7][2],    s[7][3], s[7][4], s[7][5],    s[7][6], s[7][7], s[7][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[8][0], s[8][1], s[8][2],    s[8][3], s[8][4], s[8][5],    s[8][6], s[8][7], s[8][8]);
    printf("+-------+-------+-------+\n");

    answer += ((s[0][0] - '0') * 100)
            + ((s[0][1] - '0') * 10)
            + ((s[0][2] - '0') * 1);
    printf("Answer = %d\n", answer);
}

void print_sudoku ()
{
    char s[9][9];
    int i, j;

    for (i=0; i<9; i++) {
        for (j=0; j<9; j++) {
            if (sudoku[i][j] == 0)  s[i][j] = '.';
            if (sudoku[i][j] == 1)  s[i][j] = '1';
            if (sudoku[i][j] == 2)  s[i][j] = '2';
            if (sudoku[i][j] == 3)  s[i][j] = '3';
            if (sudoku[i][j] == 4)  s[i][j] = '4';
            if (sudoku[i][j] == 5)  s[i][j] = '5';
            if (sudoku[i][j] == 6)  s[i][j] = '6';
            if (sudoku[i][j] == 7)  s[i][j] = '7';
            if (sudoku[i][j] == 8)  s[i][j] = '8';
            if (sudoku[i][j] == 9)  s[i][j] = '9';
        }
    }

    printf("+-------+-------+-------+\n");
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[0][0], s[0][1], s[0][2],    s[0][3], s[0][4], s[0][5],    s[0][6], s[0][7], s[0][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[1][0], s[1][1], s[1][2],    s[1][3], s[1][4], s[1][5],    s[1][6], s[1][7], s[1][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[2][0], s[2][1], s[2][2],    s[2][3], s[2][4], s[2][5],    s[2][6], s[2][7], s[2][8]);
    printf("+-------+-------+-------+\n");
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[3][0], s[3][1], s[3][2],    s[3][3], s[3][4], s[3][5],    s[3][6], s[3][7], s[3][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[4][0], s[4][1], s[4][2],    s[4][3], s[4][4], s[4][5],    s[4][6], s[4][7], s[4][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[5][0], s[5][1], s[5][2],    s[5][3], s[5][4], s[5][5],    s[5][6], s[5][7], s[5][8]);
    printf("+-------+-------+-------+\n");
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[6][0], s[6][1], s[6][2],    s[6][3], s[6][4], s[6][5],    s[6][6], s[6][7], s[6][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[7][0], s[7][1], s[7][2],    s[7][3], s[7][4], s[7][5],    s[7][6], s[7][7], s[7][8]);
    printf("| %c %c %c | %c %c %c | %c %c %c |\n",  s[8][0], s[8][1], s[8][2],    s[8][3], s[8][4], s[8][5],    s[8][6], s[8][7], s[8][8]);
    printf("+-------+-------+-------+\n");
}

void mark_num (int x, int y, int value)
{
    int i, j;
    if (value != 0) {
        // Mark the column
        blkd[0][y][value]++;  blkd[1][y][value]++;  blkd[2][y][value]++;
        blkd[3][y][value]++;  blkd[4][y][value]++;  blkd[5][y][value]++;
        blkd[6][y][value]++;  blkd[7][y][value]++;  blkd[8][y][value]++;
        blkd[x][y][value]--;

        // Mark the row
        blkd[x][0][value]++;  blkd[x][1][value]++;  blkd[x][2][value]++;
        blkd[x][3][value]++;  blkd[x][4][value]++;  blkd[x][5][value]++;
        blkd[x][6][value]++;  blkd[x][7][value]++;  blkd[x][8][value]++;
        blkd[x][y][value]--;

        // Mark the box
        i = 3*(x / 3);  j = 3*(y / 3);
        blkd[i+0][j+0][value]++;  blkd[i+0][j+1][value]++;  blkd[i+0][j+2][value]++;
        blkd[i+1][j+0][value]++;  blkd[i+1][j+1][value]++;  blkd[i+1][j+2][value]++;
        blkd[i+2][j+0][value]++;  blkd[i+2][j+1][value]++;  blkd[i+2][j+2][value]++;
        blkd[x][y][value]--;

        // Mark the other numbers
        blkd[x][y][1]++;  blkd[x][y][2]++;  blkd[x][y][3]++;
        blkd[x][y][4]++;  blkd[x][y][5]++;  blkd[x][y][6]++;
        blkd[x][y][7]++;  blkd[x][y][8]++;  blkd[x][y][9]++;
        blkd[x][y][value]--;
    }
}

void unmark_num (int x, int y, int value)
{
    int i, j;
    if (value != 0) {
        // Unmark the column
        blkd[0][y][value]--;  blkd[1][y][value]--;  blkd[2][y][value]--;
        blkd[3][y][value]--;  blkd[4][y][value]--;  blkd[5][y][value]--;
        blkd[6][y][value]--;  blkd[7][y][value]--;  blkd[8][y][value]--;
        blkd[x][y][value]++;

        // Unmark the row
        blkd[x][0][value]--;  blkd[x][1][value]--;  blkd[x][2][value]--;
        blkd[x][3][value]--;  blkd[x][4][value]--;  blkd[x][5][value]--;
        blkd[x][6][value]--;  blkd[x][7][value]--;  blkd[x][8][value]--;
        blkd[x][y][value]++;

        // Unmark the box
        i = 3*(x / 3);  j = 3*(y / 3);
        blkd[i+0][j+0][value]--;  blkd[i+0][j+1][value]--;  blkd[i+0][j+2][value]--;
        blkd[i+1][j+0][value]--;  blkd[i+1][j+1][value]--;  blkd[i+1][j+2][value]--;
        blkd[i+2][j+0][value]--;  blkd[i+2][j+1][value]--;  blkd[i+2][j+2][value]--;
        blkd[x][y][value]++;

        // Unmark the other numbers
        blkd[x][y][1]--;  blkd[x][y][2]--;  blkd[x][y][3]--;
        blkd[x][y][4]--;  blkd[x][y][5]--;  blkd[x][y][6]--;
        blkd[x][y][7]--;  blkd[x][y][8]--;  blkd[x][y][9]--;
        blkd[x][y][value]++;
    }
}

void read_sudoku ()
{
    (void)fgets(name, 256, fin);
    for (i=0; i<9; i++) {
        (void)fgets(temp, 10, fin);
        fscanf(fin, "\n");
     // printf("%s\n", temp);
        for (j=0; j<9; j++) {
            sudoku[i][j] = temp[j] - '0';
         // printf("sudoku[%d][%d] = %d\n", i, j, sudoku[i][j]);
        }
    }
}

void init_sudoku ()
{
    // Initialize everything to 0
    for (i=0; i<9; i++) {
        for (j=0; j<9; j++) {
            for (k=1; k<=9; k++) {
                blkd[i][j][k] = 0;
            }
        }
    }

    // Mark every starter value
    for (i=0; i<9; i++) {
        for (j=0; j<9; j++) {
            if (sudoku[i][j] != 0){
                mark_num(i, j, sudoku[i][j]);
             // printf("mark_num(%d, %d, %d)\n", i, j, sudoku[i][j]);
             // print_blkd();
            }
        }
    }
}

void try_num (int x, int y, int num)
{
    int i, j, n; 

    tries++;
  //printf("try_num(%d, %d, %d);\n", x, y, num);

    mark_num(x, y, num);

    if ((x == 8) && (y == 8))
    {   // Solution found
        print_solution();
        //print_blkd();
        solutions_found++;
    }
    else if (y == 8)
    {   // End of row, wrap around to next row
        for (n=1; n<=9; n++) {
            if (!blkd[x+1][0][n])
                try_num(x+1, 0, n);
        }
    }
    else
    {   // Not end of row, continue on current row
        for (n=1; n<=9; n++) {
            if (!blkd[x][y+1][n])
                try_num(x, y+1, n);
        }
    }

    unmark_num(x, y, num);
}

void solve_sudoku ()
{
    int n;

    init_sudoku();

    tries = 0;
    solutions_found = 0;
    for (n=1; n<=9; n++) {
        if (!blkd[0][0][n])
            try_num(0, 0, n);
    }

    if (solutions_found == 0)  printf("ERROR: No solutions found!\n");
    if (solutions_found == 1)  printf("One solution found, tries = %d.\n", tries);
    if (solutions_found > 1)   printf("ERROR: Multiple solutions found!\n");
}

int main()
{
    int i;

  //if ((fin=fopen("mini_sudoku.txt", "r"))!=NULL)
    if ((fin=fopen("sudoku.txt", "r"))!=NULL)
        printf("Opened %s\n", "mini_sudoku.txt");

    for (i = 0; i < 50; i++) {
        read_sudoku();
        print_sudoku();
        solve_sudoku();
    }

    printf("Done\n");
}
